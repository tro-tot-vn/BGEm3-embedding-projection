============================================================
ðŸŽ¯ BGE-M3 MODEL EVALUATION
============================================================
Device: cuda
ðŸ“¦ Loading model from: /content/BGEm3-embedding-projection/checkpoints/bgem3_projection_best.pt
2025-10-26 09:56:48.257603: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:467] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1761472608.277746   44074 cuda_dnn.cc:8579] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1761472608.283902   44074 cuda_blas.cc:1407] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
W0000 00:00:1761472608.300189   44074 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1761472608.300217   44074 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1761472608.300223   44074 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1761472608.300227   44074 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
2025-10-26 09:56:48.305672: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
   Epoch: 16
   Loss: 1.8215
âœ… Model loaded successfully

ðŸ“‚ Loading data from: /content/BGEm3-embedding-projection/data/new-data-set/test-data-set-1.json
âœ… Using last 10% of data: 96 test examples

ðŸ“Š Evaluating on 96 examples...
ðŸ”„ Encoding queries...
Queries: 100% 3/3 [00:00<00:00,  3.82it/s]
ðŸ”„ Encoding documents...
Documents: 100% 3/3 [00:00<00:00,  6.68it/s]
ðŸ”„ Computing similarities...
ðŸ”„ Computing metrics...

============================================================
ðŸ“Š EVALUATION RESULTS
============================================================
MRR         :  98.44% â”‚â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â”‚
Recall@1    :  96.88% â”‚â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â”‚
Recall@5    : 100.00% â”‚â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ”‚
Recall@10   : 100.00% â”‚â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ”‚
Recall@50   : 100.00% â”‚â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ”‚
============================================================

ðŸ’¡ Interpretation:
   ðŸŸ¢ Excellent! Model retrieves correct docs very accurately.

   In top-10 results: 100.0% queries find correct match

============================================================
ðŸ” EXAMPLE PREDICTIONS
============================================================

ðŸ“ Example 1:
   Query: PhÃ²ng trá» GÃ² Váº¥p 18mÂ² 3tr5 cÃ³ wc riÃªng, khÃ´ng chung chá»§...

   Similarities:
   âœ… Positive:    0.9470 - PhÃ²ng trá» GÃ² Váº¥p 18mÂ² giÃ¡ 3tr5, cÃ³ wc riÃªng, mÃ¡y láº¡nh, khÃ´ng...
   âŒ Negative 1:  0.3663 - PhÃ²ng trá» Quáº­n 12 18mÂ² giÃ¡ 3tr5, cÃ³ wc riÃªng, mÃ¡y láº¡nh, khÃ´n...
   âŒ Negative 2:  0.4107 - PhÃ²ng trá» GÃ² Váº¥p 18mÂ² giÃ¡ 4tr2, cÃ³ wc riÃªng, mÃ¡y láº¡nh, khÃ´ng...
   âŒ Negative 3:  0.8278 - PhÃ²ng trá» GÃ² Váº¥p 18mÂ² giÃ¡ 3tr5, cÃ³ wc chung, mÃ¡y láº¡nh, khÃ´ng...
   âœ… Correct! Positive has highest similarity
   ðŸ“Š Margin: +0.1192 (higher is better)

ðŸ“ Example 2:
   Query: phÃ²ng trá» Long BiÃªn 20mÂ² 4tr cÃ³ mÃ¡y láº¡nh, wc riÃªng...

   Similarities:
   âœ… Positive:    0.9139 - PhÃ²ng trá» Long BiÃªn 20mÂ² giÃ¡ 4tr, cÃ³ mÃ¡y láº¡nh, wc riÃªng, ban...
   âŒ Negative 1:  0.5882 - PhÃ²ng trá» Nam Tá»« LiÃªm 20mÂ² giÃ¡ 4tr, cÃ³ mÃ¡y láº¡nh, wc riÃªng, b...
   âŒ Negative 2:  0.4384 - PhÃ²ng trá» Long BiÃªn 20mÂ² giÃ¡ 5tr, cÃ³ mÃ¡y láº¡nh, wc riÃªng, ban...
   âŒ Negative 3:  0.6497 - PhÃ²ng trá» Long BiÃªn 16mÂ² giÃ¡ 4tr, cÃ³ mÃ¡y láº¡nh, wc riÃªng, ban...
   âœ… Correct! Positive has highest similarity
   ðŸ“Š Margin: +0.2642 (higher is better)

ðŸ“ Example 3:
   Query: Cáº§n thuÃª phÃ²ng trá» Quáº­n 2, 30mÂ², 6tr5, cÃ³ báº¿p, ban cÃ´ng, khÃ´ng chung chá»§...

   Similarities:
   âœ… Positive:    0.9558 - PhÃ²ng trá» Quáº­n 2 30mÂ² giÃ¡ 6tr5, cÃ³ báº¿p, ban cÃ´ng, mÃ¡y láº¡nh, ...
   âŒ Negative 1:  0.5822 - PhÃ²ng trá» Quáº­n 9 30mÂ² giÃ¡ 6tr5, cÃ³ báº¿p, ban cÃ´ng, mÃ¡y láº¡nh, ...
   âŒ Negative 2:  0.4657 - PhÃ²ng trá» Quáº­n 2 30mÂ² giÃ¡ 8tr, cÃ³ báº¿p, ban cÃ´ng, mÃ¡y láº¡nh, w...
   âŒ Negative 3:  0.7146 - PhÃ²ng trá» Quáº­n 2 25mÂ² giÃ¡ 6tr5, cÃ³ báº¿p, ban cÃ´ng, mÃ¡y láº¡nh, ...
   âœ… Correct! Positive has highest similarity
   ðŸ“Š Margin: +0.2411 (higher is better)

ðŸ“ Example 4:
   Query: phÃ²ng trá» q10 4tr 20m2 cÃ³ mÃ¡y láº¡nh wc riÃªng gáº§n chá»£...

   Similarities:
   âœ… Positive:    0.9036 - PhÃ²ng trá» Quáº­n 10, 20mÂ², giÃ¡ 4tr, cÃ³ mÃ¡y láº¡nh, wc riÃªng, ban...
   âŒ Negative 1:  0.5424 - PhÃ²ng trá» Quáº­n 3, 20mÂ², giÃ¡ 4tr, cÃ³ mÃ¡y láº¡nh, wc riÃªng, ban ...
   âŒ Negative 2:  0.4183 - PhÃ²ng trá» Quáº­n 10, 20mÂ², giÃ¡ 5.5tr, cÃ³ mÃ¡y láº¡nh, wc riÃªng, b...
   âŒ Negative 3:  0.2574 - PhÃ²ng trá» Quáº­n 10, 15mÂ², giÃ¡ 4tr, cÃ³ mÃ¡y láº¡nh, wc chung, khÃ´...
   âœ… Correct! Positive has highest similarity
   ðŸ“Š Margin: +0.3612 (higher is better)

ðŸ“ Example 5:
   Query: Cáº§n thuÃª phÃ²ng quáº­n BÃ¬nh Tháº¡nh, 25mÂ², giÃ¡ 5tr, cÃ³ ban cÃ´ng, khÃ´ng chung chá»§...

   Similarities:
   âœ… Positive:    0.9098 - PhÃ²ng trá» Quáº­n BÃ¬nh Tháº¡nh, 25mÂ², giÃ¡ 5tr, cÃ³ mÃ¡y láº¡nh, wc ri...
   âŒ Negative 1:  0.4845 - PhÃ²ng trá» Quáº­n GÃ² Váº¥p, 25mÂ², giÃ¡ 5tr, cÃ³ mÃ¡y láº¡nh, wc riÃªng,...
   âŒ Negative 2:  0.4175 - PhÃ²ng trá» Quáº­n BÃ¬nh Tháº¡nh, 25mÂ², giÃ¡ 6.5tr, cÃ³ mÃ¡y láº¡nh, wc ...
   âŒ Negative 3:  0.5500 - PhÃ²ng trá» Quáº­n BÃ¬nh Tháº¡nh, 35mÂ², giÃ¡ 5tr, cÃ³ mÃ¡y láº¡nh, wc ri...
   âœ… Correct! Positive has highest similarity
   ðŸ“Š Margin: +0.3598 (higher is better)

============================================================
âœ… Evaluation complete!
============================================================
